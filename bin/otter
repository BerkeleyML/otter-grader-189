#!/usr/bin/env python3

###############################
##### Otter-Grader Binary #####
###############################

import sys

from textwrap import dedent
from otter.argparser import get_parser

parser, MISSING_PACKAGES = get_parser()

if __name__ == "__main__":

    if MISSING_PACKAGES:
        raise ImportError(
            "Missing some packages required for otter service. "
            "Please install all requirements at "
            "https://raw.githubusercontent.com/ucbds-infra/otter-grader/master/requirements.txt"
        )

    args = parser.parse_args()
    if hasattr(args, 'func'):
        args.func(args)
    elif len(sys.argv) > 1 and sys.argv[1] == "generate":
        print(dedent("""\
        You must specify a command for Otter Generate:
            autograder
            token"""))
    elif len(sys.argv) > 1 and sys.argv[1] == "service":
        print(dedent("""\
        You must specify a command for Otter Service:
            build
            create
            start"""))
    else:
        print(dedent("""\
        You must specify a command for Otter:
            assign
            check
            export
            generate
            grade
            service"""))
